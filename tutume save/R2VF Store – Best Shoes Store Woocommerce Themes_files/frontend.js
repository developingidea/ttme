jQuery(function($){"use strict";$(document).ready(function(){var renderPin=function(){var map=$('.wr-mapper'),pin=$('.wrm-pin'),_img_width=map.data('width'),_img_height=map.data('height');pin.each(function(){var _pin_top=$(this).data('top'),_pin_left=$(this).data('left');$(this).css({"top":(_pin_top/_img_height)*100+'%',"left":(_pin_left/_img_width)*100+'%',})})};var initPopup=function(){var pin=$('.wrm-pin .icon-pin');pin.on('click',function(){var _this=$(this),_this_attr=_this[0].getBoundingClientRect(),popup_width=_this.siblings('.wrm-popup').width(),browser_width=$(window).width(),parent=_this.closest('.wrm-pin').data('position'),offset_right=browser_width-(_this_attr.right+popup_width+8),offset_left=_this_attr.left-popup_width+8;if(!_this.siblings('.wrm-title').hasClass('actived')){$('.wrm-pin').children().removeClass('actived');}_this.siblings().toggleClass('actived');$('.wrm-pin .close-modal').on('click',function(){$('.wrm-popup, .wrm-title').removeClass('actived');});switch(parent){case'right':if(offset_right<0){_this.siblings('.wrm-popup').removeClass('right').addClass('left');}else{_this.siblings('.wrm-popup').removeClass('left').addClass('right');}break;case'left':if(offset_left<0){_this.siblings('.wrm-popup').removeClass('left').addClass('right');}else{_this.siblings('.wrm-popup').removeClass('right').addClass('left');}break;}});var filter_blur='blur(2px)',filter_gray='grayscale(100%)',flag=false;pin.hover(function(){flag=true;pin.closest('.blur').children('img').css('filter',filter_blur).css('webkitFilter',filter_blur).css('mozFilter',filter_blur).css('oFilter',filter_blur).css('msFilter',filter_blur);pin.closest('.gray').children('img').css('filter',filter_gray).css('webkitFilter',filter_gray).css('mozFilter',filter_gray).css('oFilter',filter_gray).css('msFilter',filter_gray);pin.closest('.mask').children('.mask').css('opacity',1);},function(){flag=false;pin.closest('.wr-mapper').children('img').removeAttr('style');pin.closest('.mask').children('.mask').removeAttr('style');});}
renderPin();initPopup();});});